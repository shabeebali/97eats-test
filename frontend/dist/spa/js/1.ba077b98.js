(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{b6c4:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{staticClass:"q-px-md"},[a("q-card",{staticClass:"q-mt-md"},[a("q-toolbar",[a("q-toolbar-title",[e._v(e._s(e.pageTitle))]),a("q-btn",{attrs:{label:"Save",color:"green"},on:{click:e.saveFn}})],1),a("q-separator"),a("q-form",{ref:"form"},[a("q-card-section",[a("div",{staticClass:"row q-col-gutter-md"},[a("div",{staticClass:"col-12 col-md-6"},[a("q-input",{attrs:{label:"Name",filled:"",rules:[function(e){return!!e||"Required"}]},model:{value:e.model.name,callback:function(t){e.$set(e.model,"name",t)},expression:"model.name"}})],1),a("div",{staticClass:"col-12 col-md-6"},[a("q-input",{attrs:{label:"Category",filled:"",rules:[function(e){return!!e||"Required"}]},model:{value:e.model.category,callback:function(t){e.$set(e.model,"category",t)},expression:"model.category"}})],1)]),a("div",{staticClass:"row q-mt-md"},[a("div",{staticClass:"col-12"},[a("div",{staticClass:"text-subtitle2"},[e._v("Description")]),a("q-editor",{attrs:{rows:"2"},model:{value:e.model.description,callback:function(t){e.$set(e.model,"description",t)},expression:"model.description"}})],1)]),a("div",{staticClass:"row q-col-gutter-md q-mt-md"},[a("div",{staticClass:"col-12 col-md-6"},[a("q-uploader",{ref:"thumbnailUploaderRef",staticStyle:{width:"100%"},attrs:{url:e.$axios.defaults.baseURL+"/image",accept:".jpg, image/*","max-files":1,label:"Upload Thumbnail Image",headers:e.imgUploadHeaders,"field-name":"file"},on:{uploaded:e.thumbnailUploaded}})],1),a("div",{staticClass:"col-12 col-md-6"},[a("q-uploader",{ref:"coverUploaderRef",staticStyle:{width:"100%"},attrs:{url:e.$axios.defaults.baseURL+"/image","max-files":1,accept:".jpg, image/*",label:"Upload Cover Image",headers:e.imgUploadHeaders,"field-name":"file"},on:{uploaded:e.coverImageUploaded}})],1)]),a("div",{staticClass:"row q-mt-md justify-center q-col-gutter-md"},[e.model.thumbnail_image?a("div",{staticClass:"col-6 col-md-3"},[a("q-card",[a("q-img",{attrs:{src:e.getImgSrc(e.model.thumbnail_image)},on:{click:function(t){e.imgSrc=e.getImgSrc(e.model.thumbnail_image),e.imageDialog=!0}}}),a("q-card-actions",{staticClass:"justify-center flex"},[a("q-btn",{attrs:{flat:"",label:"Delete Thumbnail Image","no-caps":""},on:{click:function(t){e.model.thumbnail_image=null}}})],1)],1)],1):e._e(),e.model.cover_image?a("div",{staticClass:"col-6 col-md-3"},[a("q-card",[a("q-img",{attrs:{src:e.getImgSrc(e.model.cover_image)},on:{click:function(t){e.imgSrc=e.getImgSrc(e.model.cover_image),e.imageDialog=!0}}}),a("q-card-actions",{staticClass:"justify-center flex"},[a("q-btn",{attrs:{flat:"",label:"Delete Cover Image","no-caps":""},on:{click:function(t){e.model.cover_image=null}}})],1)],1)],1):e._e()]),a("div",{staticClass:"row q-mt-md q-col-gutter-md"},[a("div",{staticClass:"col-12 col-md-4"},[a("q-input",{attrs:{label:"Location",filled:"",rules:[function(e){return!!e||"Required"}]},model:{value:e.model.location,callback:function(t){e.$set(e.model,"location",t)},expression:"model.location"}})],1),a("div",{staticClass:"col-12 col-md-4"},[a("q-select",{attrs:{label:"Delivery Method",options:["Take Away","Home Delivery"],filled:"",rules:[function(e){return!!e||"Required"}]},on:{input:e.changedDeliveryMethod},model:{value:e.model.delivery_method,callback:function(t){e.$set(e.model,"delivery_method",t)},expression:"model.delivery_method"}})],1),a("div",{staticClass:"col-12 col-md-4"},[a("q-input",{staticClass:"input-right",attrs:{disable:"Take Away"===e.model.delivery_method,label:"Delivery Charge",filled:"",rules:[e.deliveryChargeValidation]},model:{value:e.model.delivery_charge,callback:function(t){e.$set(e.model,"delivery_charge",e._n(t))},expression:"model.delivery_charge"}})],1)])])],1),a("q-separator"),a("q-card-section",[a("q-table",{attrs:{title:"Items",data:e.model.items,columns:e.columns,"rows-per-page-options":[0]},scopedSlots:e._u([{key:"top-right",fn:function(){return[a("q-btn",{attrs:{color:"pink-8",label:"Add Item","no-caps":""},on:{click:e.addItem}})]},proxy:!0},{key:"body-cell-addons",fn:function(t){return[a("q-td",{attrs:{props:t}},[a("ul",e._l(t.row.addons,(function(t,i){return a("li",{key:i},[e._v("\n              "+e._s(t.name)+"\n              "),t.options.length>0?a("ul",e._l(t.options,(function(t){return a("li",{key:t.name},[e._v("\n                  "+e._s(t.name)+": "+e._s(t.price)+" AED\n                ")])})),0):e._e()])})),0)])]}},{key:"body-cell-actions",fn:function(t){return[a("q-td",{attrs:{props:t}},[a("q-btn",{attrs:{flat:"",label:"Edit",icon:"edit"},on:{click:function(a){return e.editItem(t.row)}}}),a("q-btn",{attrs:{flat:"",label:"Delete",icon:"delete",color:"red"},on:{click:function(a){return e.deleteItem(t.row)}}})],1)]}},{key:"body-cell-thumbnail_image",fn:function(t){return[a("q-td",{attrs:{props:t}},[a("q-img",{attrs:{src:e.getImgSrc(t.row.thumbnail_image),width:"75px",height:"75px"},on:{click:function(a){e.imgSrc=e.getImgSrc(t.row.thumbnail_image),e.imageDialog=!0}}})],1)]}},{key:"body-cell-cover_image",fn:function(t){return[a("q-td",{attrs:{props:t}},[a("q-img",{attrs:{src:e.getImgSrc(t.row.cover_image),width:"75px",height:"75px"},on:{click:function(a){e.imgSrc=e.getImgSrc(t.row.cover_image),e.imageDialog=!0}}})],1)]}}])})],1)],1),a("q-dialog",{attrs:{maximized:""},model:{value:e.itemDialog,callback:function(t){e.itemDialog=t},expression:"itemDialog"}},[a("q-card",[a("q-toolbar",{staticClass:"bg-pink-9 text-white",attrs:{dark:""}},[a("q-toolbar-title",[e._v("Add Item")]),a("q-btn",{attrs:{flat:"",label:"Save Item","no-caps":""},on:{click:e.saveItem}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",round:"",dense:"",icon:"close"}})],1),a("q-form",{ref:"itemFormRef"},[a("q-card-section",[a("div",{staticClass:"row q-col-gutter-md"},[a("div",{staticClass:"col-12 col-md-6"},[a("q-input",{attrs:{filled:"",label:"Name",rules:[function(e){return!!e||"Required"}]},model:{value:e.item.name,callback:function(t){e.$set(e.item,"name",t)},expression:"item.name"}})],1),a("div",{staticClass:"col-6 col-md-3"},[a("q-input",{attrs:{filled:"",label:"Category",rules:[function(e){return!!e||"Required"}]},model:{value:e.item.category,callback:function(t){e.$set(e.item,"category",t)},expression:"item.category"}})],1),a("div",{staticClass:"col-6 col-md-3"},[a("q-input",{staticClass:"input-right",attrs:{filled:"",label:"Price",rules:[e.priceValidation]},model:{value:e.item.price,callback:function(t){e.$set(e.item,"price",e._n(t))},expression:"item.price"}})],1)]),a("div",{staticClass:"row q-mt-md col-col-gutter-md"},[a("div",{staticClass:"col-12"},[a("div",{staticClass:"text-subtitle2"},[e._v("Description")]),a("q-editor",{attrs:{rows:"2"},model:{value:e.item.description,callback:function(t){e.$set(e.item,"description",t)},expression:"item.description"}})],1)]),a("div",{staticClass:"row q-col-gutter-md q-mt-md"},[a("div",{staticClass:"col-12 col-md-6"},[a("q-uploader",{ref:"itemThumbnailUploaderRef",staticStyle:{width:"100%"},attrs:{url:e.$axios.defaults.baseURL+"/image",accept:".jpg, image/*","max-files":1,label:"Upload Thumbnail Image",headers:e.imgUploadHeaders,"field-name":"file"},on:{uploaded:e.itemThumbnailUploaded}})],1),a("div",{staticClass:"col-12 col-md-6"},[a("q-uploader",{ref:"itemCoverUploaderRef",staticStyle:{width:"100%"},attrs:{url:e.$axios.defaults.baseURL+"/image","max-files":1,accept:".jpg, image/*",label:"Upload Cover Image",headers:e.imgUploadHeaders,"field-name":"file"},on:{uploaded:e.itemCoverImageUploaded}})],1)]),a("div",{staticClass:"row q-mt-md justify-center q-col-gutter-md"},[e.item.thumbnail_image?a("div",{staticClass:"col-6 col-md-3"},[a("q-card",[a("q-img",{attrs:{src:e.getImgSrc(e.item.thumbnail_image)},on:{click:function(t){e.imgSrc=e.getImgSrc(e.item.thumbnail_image),e.imageDialog=!0}}}),a("q-card-actions",{staticClass:"justify-center flex"},[a("q-btn",{attrs:{flat:"",label:"Delete Thumbnail Image","no-caps":""},on:{click:function(t){e.item.thumbnail_image=null}}})],1)],1)],1):e._e(),e.item.cover_image?a("div",{staticClass:"col-6 col-md-3"},[a("q-card",[a("q-img",{attrs:{src:e.getImgSrc(e.item.cover_image)},on:{click:function(t){e.imgSrc=e.getImgSrc(e.item.cover_image),e.imageDialog=!0}}}),a("q-card-actions",{staticClass:"justify-center flex"},[a("q-btn",{attrs:{flat:"",label:"Delete Cover Image","no-caps":""},on:{click:function(t){e.item.cover_image=null}}})],1)],1)],1):e._e()])]),a("q-separator"),a("q-card-section",[a("q-table",{attrs:{title:"Addons",data:e.item.addons,columns:e.addonColumns},scopedSlots:e._u([{key:"top-right",fn:function(){return[a("q-btn",{attrs:{label:"Add Addon","no-caps":"",color:"pink-9"},on:{click:e.addAddon}})]},proxy:!0},{key:"body-cell-actions",fn:function(t){return[a("q-td",{attrs:{props:t}},[a("q-btn",{attrs:{label:"Edit",flat:"",icon:"edit","no-caps":""},on:{click:function(a){return e.editAddon(t.row)}}}),a("q-btn",{attrs:{flat:"",label:"Delete",icon:"delete",color:"red"},on:{click:function(a){return e.deleteAddon(t.row)}}})],1)]}},{key:"body-cell-options",fn:function(t){return[a("q-td",{attrs:{props:t}},[a("ul",e._l(t.row.options,(function(t,i){return a("li",{key:i},[e._v(e._s(t.name)+": "+e._s(t.price)+" AED")])})),0)])]}}])})],1)],1),a("q-card-actions",[a("q-btn",{attrs:{color:"green",label:"Save Item","no-caps":""},on:{click:e.saveItem}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Cancel","no-caps":""}})],1)],1)],1),a("q-dialog",{attrs:{"full-width":""},model:{value:e.imageDialog,callback:function(t){e.imageDialog=t},expression:"imageDialog"}},[a("q-card",[a("q-toolbar",[a("q-toolbar-title",[e._v("Image Preview")]),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",round:"",dense:"",icon:"close"}})],1),a("q-img",{attrs:{src:e.imgSrc}})],1)],1),a("q-dialog",{model:{value:e.addonDialog,callback:function(t){e.addonDialog=t},expression:"addonDialog"}},[a("q-card",{staticStyle:{width:"500px","max-width":"100%"}},[a("q-toolbar",{staticClass:"bg-pink-7 text-white"},[a("q-toolbar-title",[e._v("Add Addon")]),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",round:"",dense:"",icon:"close"}})],1),a("q-form",{ref:"addonFormRef"},[a("q-card-section",[a("q-input",{attrs:{filled:"",label:"Addon Title",rules:[function(e){return!!e||"Required"}]},model:{value:e.addon.name,callback:function(t){e.$set(e.addon,"name",t)},expression:"addon.name"}})],1),a("q-separator"),a("q-card-section",[a("div",{staticClass:"text-subtitle2"},[e._v("Options")]),e._l(e.addon.options,(function(t,i){return a("div",{key:i,staticClass:"row q-col-gutter-md"},[a("div",{staticClass:"col-6"},[a("q-input",{attrs:{label:"Name",filled:"",dense:"",rules:[function(e){return!!e||"Required"}]},model:{value:e.addon.options[i].name,callback:function(t){e.$set(e.addon.options[i],"name",t)},expression:"addon.options[i].name"}})],1),a("div",{staticClass:"col-5"},[a("q-input",{staticClass:"input-right",attrs:{label:"Price",filled:"",dense:"",rules:[e.priceValidation]},model:{value:e.addon.options[i].price,callback:function(t){e.$set(e.addon.options[i],"price",e._n(t))},expression:"addon.options[i].price"}})],1),a("div",{staticClass:"col-1"},[e.addon.options.length>1?a("q-btn",{attrs:{flat:"",round:"",icon:"delete",color:"red"},on:{click:function(a){return e.deleteOption(t,i)}}}):e._e()],1)])})),a("div",{staticClass:"row q-mt-sm"},[a("q-btn",{attrs:{color:"pink-9",label:"Add Option","no-caps":""},on:{click:e.addOption}})],1)],2)],1),a("q-card-actions",[a("q-btn",{attrs:{label:"Save","no-caps":"",color:"green"},on:{click:e.saveAddon}}),a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Cancel",flat:"","no-caps":""}})],1)],1)],1)],1)},l=[],o=(a("a79d"),a("e01a"),{data(){return{imageDialog:!1,imgSrc:null,addonDialog:!1,addonEdit:!1,addon:{name:null,options:[]},itemDialog:!1,itemEdit:!1,item:{name:null,category:null,description:"",thumbnail_image:null,cover_image:null,addons:[],price:0},model:{name:null,category:null,thumbnail_image:null,cover_image:null,description:"",location:null,delivery_method:null,delivery_charge:0,items:[]},addonColumns:[{name:"name",field:"name",label:"Name",align:"left",sortable:!0},{name:"options",field:"options",label:"Options",align:"left",sortable:!1},{name:"actions",field:"actions",label:"Actions",align:"right",sortable:!1}],columns:[{name:"name",field:"name",label:"Name",align:"left",sortable:!0},{name:"price",field:"price",label:"Price",align:"right",sortable:!0},{name:"thumbnail_image",field:"thumbnail_image",label:"Thumbnail",align:"center",sortable:!1},{name:"cover_image",field:"cover_image",label:"Cover",align:"center",sortable:!1},{name:"addons",field:"addons",label:"Addons",align:"left",sortable:!1},{name:"actions",field:"actions",label:"Actions",align:"right",sortable:!1}]}},computed:{pageTitle(){return this.$route.params.id?"Edit: "+this.model.name:"Create New Restaurant"},imgUploadHeaders(){const e=localStorage.getItem("token");return[{name:"Authorization",value:"Bearer "+e}]}},mounted(){this.$route.params.id&&(this.$q.loading.show(),this.$axios.get("restaurants/"+this.$route.params.id).then((e=>{this.model=e.data,this.model.description||(this.model.description=""),this.model.items.forEach(((e,t)=>{this.item.description||(this.model.items[t].description="")}))})).finally((()=>{this.$q.loading.hide()})))},methods:{changedDeliveryMethod(e){"Take Away"===e&&(this.model.delivery_charge=0)},imgSelected(e){console.log(e)},getImgSrc(e){if(e){const t=this.$axios.defaults.baseURL.substr(0,this.$axios.defaults.baseURL.length-4);return t+"/storage/"+e}return""},thumbnailUploaded({xhr:e}){this.model.thumbnail_image=e.response,this.$refs.thumbnailUploaderRef.removeUploadedFiles()},coverImageUploaded({xhr:e}){this.model.cover_image=e.response,this.$refs.coverUploaderRef.removeUploadedFiles()},itemThumbnailUploaded({xhr:e}){this.item.thumbnail_image=e.response,this.$refs.itemThumbnailUploaderRef.removeUploadedFiles()},itemCoverImageUploaded({xhr:e}){this.item.cover_image=e.response,this.$refs.itemCoverUploaderRef.removeUploadedFiles()},addItem(){this.itemEdit=!1,this.item={name:null,category:null,description:"",thumbnail_image:null,cover_image:null,addons:[],price:0},this.itemDialog=!0},editItem(e){this.itemEdit=!0,this.item=e,this.itemDialog=!0},priceValidation(e){return e?!isNaN(e)||"Invalid":"Required"},addAddon(){this.addonEdit=!1,this.addon={name:null,options:[{name:null,price:0}]},this.addonDialog=!0},addOption(){this.addon.options.push({name:null,price:0})},saveAddon(){this.$refs.addonFormRef.validate().then((e=>{e?this.addonEdit?this.addonDialog=!1:-1===this.$_.findIndex(this.item.addons,(e=>e.name===this.addon.name))?(this.item.addons.push(this.addon),this.addonDialog=!1):this.$q.notify({message:"Duplicate Entry",type:"negative"}):this.$q.notify({message:"There are errors in the data submitted.",type:"negative"})}))},editAddon(e){this.addonEdit=!0,this.addon=e,this.addonDialog=!0},saveItem(){this.$refs.itemFormRef.validate().then((e=>{e?this.itemEdit?this.itemDialog=!1:-1===this.$_.findIndex(this.model.items,(e=>e.name===this.item.name))?(this.model.items.push(this.item),this.itemDialog=!1):this.$q.notify({message:"Duplicate Entry",type:"negative"}):this.$q.notify({message:"There are errors in the data submitted.",type:"negative"})}))},saveFn(){this.$refs.form.validate().then((e=>{if(e){this.$q.loading.show();let e="restaurants";this.$route.params.id?(e="restaurants/"+this.$route.params.id,this.model._method="PUT",this.$axios.put(e,this.model).then((e=>{"success"===e.data.message&&(this.$q.notify({message:"Data Saved Successfully",type:"positive"}),this.$router.push("/restaurants"))})).finally((()=>{this.$q.loading.hide()}))):this.$axios.post(e,this.model).then((e=>{"success"===e.data.message&&(this.$q.notify({message:"Data Saved Successfully",type:"positive"}),this.$router.push("/restaurants"))})).finally((()=>{this.$q.loading.hide()}))}else this.$q.notify({message:"There are errors in the data submitted.",type:"negative"})}))},deliveryChargeValidation(e){return"Take Away"===this.model.delivery_method||this.priceValidation(e)},deleteOption(e,t){this.$q.dialog({title:"Confirm",message:"Do you want to delete this record?",ok:{label:"Yes",color:"red",flat:!0},cancel:{label:"No",color:"green"}}).onOk((()=>{e.id?(this.$q.loading.show(),this.$axios.delete("options/"+e.id,{_method:"DELETE"}).then((e=>{"success"===e.data.message&&this.addon.options.splice(t,1)})).finally((()=>{this.$q.loading.hide()}))):this.addon.options.splice(t,1)}))},deleteAddon(e,t){this.$q.dialog({title:"Confirm",message:"Do you want to delete this record?",ok:{label:"Yes",color:"red",flat:!0},cancel:{label:"No",color:"green"}}).onOk((()=>{e.id?(this.$q.loading.show(),this.$axios.delete("addons/"+e.id,{_method:"DELETE"}).then((e=>{"success"===e.data.message&&this.item.addons.splice(t,1)})).finally((()=>{this.$q.loading.hide()}))):this.item.addons.splice(t,1)}))},deleteItem(e,t){this.$q.dialog({title:"Confirm",message:"Do you want to delete this record?",ok:{label:"Yes",color:"red",flat:!0},cancel:{label:"No",color:"green"}}).onOk((()=>{e.id?(this.$q.loading.show(),this.$axios.delete("items/"+e.id,{_method:"DELETE"}).then((e=>{"success"===e.data.message&&this.model.items.splice(t,1)})).finally((()=>{this.$q.loading.hide()}))):this.model.items.splice(t,1)}))}}}),s=o,n=a("2877"),d=a("9989"),r=a("f09f"),c=a("65c6"),m=a("6ac5"),u=a("9c40"),p=a("eb85"),g=a("0378"),h=a("a370"),f=a("27f9"),b=a("d66b"),v=a("ee89"),q=a("068f"),y=a("4b7e"),_=a("ddd8"),C=a("eaac"),k=a("db86"),$=a("24e8"),w=a("7f67"),x=a("eebe"),D=a.n(x),I=Object(n["a"])(s,i,l,!1,null,null,null);t["default"]=I.exports;D()(I,"components",{QPage:d["a"],QCard:r["a"],QToolbar:c["a"],QToolbarTitle:m["a"],QBtn:u["a"],QSeparator:p["a"],QForm:g["a"],QCardSection:h["a"],QInput:f["a"],QEditor:b["a"],QUploader:v["a"],QImg:q["a"],QCardActions:y["a"],QSelect:_["a"],QTable:C["a"],QTd:k["a"],QDialog:$["a"]}),D()(I,"directives",{ClosePopup:w["a"]})}}]);